# [用户商品推荐](https://tianchi.aliyun.com/competition/entrance/231522/information)

## 竞赛题目 
在真实的业务场景下，我们往往需要对所有商品的一个子集构建个性化推荐模型。在完成这件任务的过程中，我们不仅需要利用用户在这个商品子集上的行为数据，往往还需要利用更丰富的用户行为数据。定义如下的符号：
- U——用户集合
- I——商品全集
- P——商品子集，P ⊆ I
- D——用户对商品全集的行为数据集合

那么我们的目标是利用D来构造U中用户对P中商品的推荐模型。

## 数据说明
本场比赛提供20000用户的完整行为数据以及百万级的商品信息。竞赛数据包含两个部分。


第一部分是用户在商品全集上的移动端行为数据（D）,表名为tianchi_fresh_comp_train_user_2w，包含如下字段：

字段|字段说明|提取说明
-|-|-
user_id|用户标识|抽样&字段脱敏|
item_id|商品标识|字段脱敏|
behavior_type|用户对商品的行为类型|包括浏览、收藏、加购物车、购买，对应取值分别是1、2、3、4。|
user_geohash|用户位置的空间标识，可以为空|由经纬度通过保密的算法生成|
item_category|商品分类标识|字段脱敏|
time|行为时间|精确到小时级别|

第二个部分是商品子集（P）,表名为tianchi_fresh_comp_train_item_2w，包含如下字段： 

字段|字段说明|提取说明
-|-|-
item_id|商品标识|抽样&字段脱敏|
item_ geohash|商品位置的空间标识，可以为空|由经纬度通过保密的算法生成|
item_category|商品分类标识|字段脱敏|

训练数据包含了抽样出来的一定量用户在一个月时间（11.18~12.18）之内的移动端行为数据（D），评分数据是这些用户在这个一个月之后的一天（12.19）对商品子集（P）的购买数据。参赛者要使用训练数据建立推荐模型，并输出用户在接下来一天对商品子集购买行为的预测结果。 

## 评分数据格式
具体计算公式如下：参赛者完成用户对商品子集的购买预测之后，需要将结果放入指定格式的数据表（非分区表）中，要求结果表名为：tianchi_mobile_recommendation_predict.csv，且以utf-8格式编码；包含user_id和item_id两列（均为string类型）,要求去除重复。

## 评分标准
准确率、召回率、F1分数；

## 问题分析
### 数据分析
- 用户数据、商品数据、用户对商品的行为数据；
- 依然需要汇总统计，构建特征；
- 训练数据为一个月的用户移动端行为数据，测试数据为之后一天的购买数据，即时间相关；

### 问题分析
该问题是典型的推荐系统问题，因此冷启动也需要考虑（推荐困境不需要，这个主要是解决推荐体验方向的问题），两部分数据：一部分是2w用户对全量商品的行为数据，一部分是全量商品的子集，目前是根据一个月的数据在接下来一天给2w用户推荐商品子集中的商品，根据实际的2w用户在当天对商品子集的购买数据来评分；

几点想法：
- 对于用户：不太好计算相似度，仅有一个位置信息可以利用，而位置信息似乎也不能代表太高的相似度指标；
- 对于商品：可以通过商品类别、用户对商品的行为两个方向来计算其相似度，并基于将相似的商品推荐给相似的用户的思路（注意不要给客户推荐完全一样的商品）进行推荐；
- 行为特点：如何区分用户行为对购买的影响，毕竟浏览和加入购物车带来的信息肯定是不同的；
- 对于时间维度：销售是有一定周期性、时间相关的领域；
- 规则推荐：例如一个用户加了购物车，那直接推荐是否就可以呢；
- 冷启动：主要利用用户相似度进行冷启动的用户推荐；
- 规则过滤：对于最终的生成结果，是否需要进行规则过滤处理，比如一个用户买过商品A，如果算法依然推荐给他商品A，那是否要通过既定规则来修改这一条推荐结果呢；

### 分享整理
- 可以将target-2当天的购买数据作为训练集标签，之前的数据区间提取特征；
- target-1当天的购买数据作为线下验证集标签，之前的数据区间提取特征。需要注意时间区间长度得一致，如果训练集用的30天，那么测试集也得用30天的数据；
- 线上就顺推一天，target之前的数据区间提取特征，预测target当天的购买情况；
- 优化问题，就是你和前几名之间的差距，大体思路大家都差不多，都是一些细节问题；
    - 比如如何选取训练数据，当时平台赛线上有将近60E的数据，是不可能全部拿来提取特征的，需要做一定的抽样；
    - 通过数据观测可以发现，越靠近target日期的商品越容易被购买，所以可以选择最近一周出现的商品来构建模型；
    - 如何构建有效的线下测评使得不依赖线上结果，有的选手会选择线下18号打标构建模型，那么怎么准确模拟线上的测评机制呢？所以一般是线下17号打标做训练集，18号做验证集。19号做线上测试集；
    
### 建模
- 11.18-12.18，预测12.19：11.18-12.17提取特征，12.18标签；
- 特征：用户，商品，类别，用户商品，用户类别，商品类别；
- 方式：统计，比率，排名，交叉，竞争；
- 粒度：基于时间粒度提取特征（月、周、日、时）；
- 模型：二分类（买 or 不买）；

### 后续优化方向
- 样本不平衡问题；
- 如何挑选训练集样本（越靠近target日期的商品越容易被购买）；
- 异常因素影响：双12，刷单用户，爬虫用户（光点不买）；
- 看了再买、买了又买；
