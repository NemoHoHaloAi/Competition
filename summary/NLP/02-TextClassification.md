# [文本分类](https://www.kaggle.com/matleonard/text-classification)

一个常见的NLP任务是文本分类，分类数据机器学习的一部分，例如垃圾邮件检测、情感分析、用户标记等等，在各个领域都有诸多应用。

## Bag of Words - 词袋模型

对于机器学习模型而言，它无法从原始的文本数据进行学习，或者说这些数据过于抽象，因此我们需要将其转换为某种数值特征。

所谓词袋，指的是我们实现根据收集到的各种文档中出现过的单词，去重后构建一个向量，向量长度为出现的单词的个数，针对每一个需要处理的文档，统计其中各个单词的出现次数，填入向量的对应位置，因此每篇文档都可以得到一个自己的向量，当然要注意，这个向量可能是很大的。另一方面TF-IDF也是一种常用的处理方式。

## 构建词袋模型

spaCy提供简单的词袋模型实现方式，模型使用简单的线性模型，`TextCategorizer`在spaCy中是一种pipe，流程如下：
1. 创建空白模型。
2. 构建pipe作为文本分类，指定分类性质、方式为词袋等。
3. 将pipe添加到空白模型中。
4. 指定分类标签。

## 训练模型

1. 重构数据为满足spaCy训练要求的格式。
2. 通常来说，小块小块的更新模型更加有效，因此一般切割为小的batch，通过update进行模型更新。
3. 将数据打断后，可以进行多次使用，重复过程2。
4. 通过losses可以输出损失。

## 预测

1. 首先待预测文本需要经过tokenizer处理。
2. 通过模型获取到上述构建并训练的pipe对象，使用其predict方法预测。
3. 结果是类别对应的概率，通过argmax可以获取到大的类别的类别名。

## [练习](https://www.kaggle.com/holoong9291/exercise-text-classification)
